{% extends "tab_base.html" %}

{% block title %} General Elements {% endblock title %}

{% block stylesheets %}
{{ block.super }}
<link href="/static/vendors/titatoggle-master/dist/titatoggle-dist.css?ver=1" rel="stylesheet">
{% endblock stylesheets %}

{% block name %}
<h2><i class="fa fa-bars"></i> Model <small></small></h2>
{% endblock %}

{% block tab %}
<div class="" role="tabpanel" data-example-id="togglable-tabs">
  <ul id="myTab" class="nav nav-tabs bar_tabs" role="tablist">
    <li role="presentation" class=""><a href="/modeling/data" aria-expanded="false">Data</a>
    </li>
    <li role="presentation" class="active"><a href="/modeling/model" aria-expanded="true">Model</a>
    </li>
    <li role="presentation" class=""><a href="/modeling/hyperparameter" aria-expanded="false">Hyperparameter</a>
    </li>
    <li role="presentation" class=""><a href="/modeling/training" aria-expanded="false">Training</a>
    </li>
    <li role="presentation" class=""><a href="/modeling/result" aria-expanded="false">Result</a>
    </li>
    <li role="presentation" class=""><a href="/modeling/inference" aria-expanded="false">Inference</a>
    </li>
    <!--<li role="presentation" class=""><a href="#tab_content3" aria-expanded="false">Result</a>-->
        <!--</li>-->
    </ul>
    <div id="myTabContent" class="tab-content">
            <!-- <section id="SimpleList" class="SimpleList"><article class="StackedListWrapper StackedListWrapper--hasScrollIndicator"><header class="StackedListHeader"><h3 class="Heading Heading--size3 Heading--colorWhite">Simple list</h3></header><ul class="StackedList StackedList--hasScroll" tabindex="0"><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item1" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item one</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item2" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item two</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item3" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item three</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item4" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item four</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li><li class="StackedListItem StackedListItem--item5"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item five</h4><div class="NopeHandle"></div></div></li><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item6" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item six</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item7" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item seven</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li><li class="StackedListItem StackedListItem--item8"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item eight</h4><div class="NopeHandle"></div></div></li><li class="StackedListItem StackedListItem--item9"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item nine</h4><div class="NopeHandle"></div></div></li><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item10" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item ten</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li><li class="StackedListItem StackedListItem--item11"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item eleven</h4><div class="NopeHandle"></div></div></li><li class="StackedListItem StackedListItem--isDraggable StackedListItem--item12" tabindex="1"><div class="StackedListContent"><h4 class="Heading Heading--size4 text-no-select">item twelve</h4><div class="DragHandle"></div><div class="Pattern Pattern--typeHalftone"></div><div class="Pattern Pattern--typePlaced"></div></div></li></ul></article></section> -->


        <div role="tabpanel" class="tab-pane fade active in" id="tab_content1" aria-labelledby="home-tab">
            <div style="width: 100%; display: flex; justify-content: space-between">
                <div class="col-xs-2">
                    <div class="draggable_operators" style="width: 100%; height: 800px; margin-right: 5px; background-color: whitesmoke; border: solid 1px black">
                        <div class="x_panel">
                            <div class="x_content">
                              <!-- start accordion -->
                              <div class="accordion" id="accordion" role="tablist" aria-multiselectable="true">
                                <div class="panel">
                                    <a class="panel-heading" role="tab" id="headingOne" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        <h4 class="panel-title">Input/Output Layers</h4>
                                    </a>
                                    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                        <div class="panel-body">
                                          <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">InputLayer</div>
                                          <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">OutputLayer</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel">
                                    <a class="panel-heading collapsed" role="tab" id="headingTwo" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                        <h4 class="panel-title">Core Layers</h4>
                                    </a>
                                    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Dense</div>
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Dropout</div>
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Flatten</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel">
                                    <a class="panel-heading collapsed" role="tab" id="headingThree" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                    <h4 class="panel-title">Convolution Layers</h4></a>
                                    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Convolution2D</div>
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">ZeroPadding2D</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel">
                                    <a class="panel-heading collapsed" role="tab" id="headingFour" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="headingFour">
                                    <h4 class="panel-title">Pooling Layers</h4></a>
                                    <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour">
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Maxpooling2D</div>
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">AveragePooling2D</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel">
                                    <a class="panel-heading collapsed" role="tab" id="headingFive" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="false" aria-controls="collapseThree">
                                    <h4 class="panel-title">Recurrent Layers</h4></a>
                                    <div id="collapseFive" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFive">
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">LSTM</div>
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">SimpleRNN</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel">
                                    <a class="panel-heading collapsed" role="tab" id="headingSix" data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseThree">
                                    <h4 class="panel-title">Normalization Layers</h4></a>
                                    <div id="collapseSix" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSix">
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">BatchNormalization</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="panel">
                                    <a class="panel-heading collapsed" role="tab" id="headingSeven" data-toggle="collapse" data-parent="#accordion" href="#collapseSeven" aria-expanded="false" aria-controls="collapseThree">
                                    <h4 class="panel-title">Well Known Model</h4></a>
                                    <div id="collapseSeven" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSeven">
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">VGG 16 Net.</div>
                                        </div>
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">VGG 19 Net.</div>
                                        </div>
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Alext Net.</div>
                                        </div>
                                        <div class="panel-body">
                                            <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Google Net.</div>
                                        </div>
                                    </div>
                                </div>
                                    <!-- end of accordion -->
                                </div>
                            </div>
                        </div>
                        <div class="draggable_operators_label"></div>
                        <div class="draggable_operators_divs"></div>
                        <!-- <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">InputLayer</div>
                        <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Convolution2D</div>
                        <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">MaxPulling2D</div>
                        <div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">OutputLayer</div> -->
                    
                        <div id="link_properties">
                          <label for="link_color">Link's color: </label><input type="color" id="link_color">
                        </div>
                    </div>
                </div>
                <div class="col-xs-8">
                    <div id="" style="flex-grow: 1; height: 60px; width: 100%; margin-bottom: 10px; ">
                        <form action="" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div>
                                {{ form }}
                                <input type="submit" value="Upload" />
                            </div>
                        </form>
                        <!-- <button class="btn btn-primary" style="margin-right: 5px;" id="save_button"><i class="fa fa-save"></i> Save</button>
                        <label class="btn btn-primary" style="margin-right: 5px;" for="inputImage" title="Upload image file">
                            <input type="file" class="sr-only" id="inputImage" name="file" accept="image/*"><i class="fa fa-upload"></i> Load
                        </label>   -->
                    </div>
                    <div id="chart_container" style="flex-grow: 1; height: 750px; width:100%; border: solid 1px black">
                        <div class="flowchart-example-container flowchart-container" id="example_9" ></div>
                    </div>
                </div>
                <div class="col-xs-2">
                    <div id="parameter_bar" class="draggable_operators" style="width: 100%; height: 800px; margin-left: 5px; background-color: whitesmoke; border: solid 1px black">
                       <!--  <div id="operator_properties" clsss="properties">
                            <label for="operator_title">title: </label><input type="text" id="operator_title">
                            <label for="operator_parameter1">parameter1: </label><input type="text" id="operator_parameter1">
                            <label for="operator_parameter2">parameter2: </label><input type="text" id="operator_parameter2">
                            <label for="operator_parameter3">parameter3: </label><input type="text" id="operator_parameter3">
                        </div> -->
                        <!-- <div id="Convolution2D_properties" class="properties">
                          <form id="picker">
                            <lable for="title">title: </lable><br><input type="text" id="operator_title"><br>
                            <lable for="filter_rows">Filter Rows : </lable><br><input type="text" id="filter_rows"><br>
                            <lable for="number_of_filters">Number of Filters : </lable><br><input type="text" id="number_of_filters"><br>
                            <lable for="filter_columns">Filter Columns : </lable><br><input type="text" id="filter_columns"><br>
                            <lable for="activation">Activation : </lable><br>
                            <select id="activation">
                                <option value="softmax">softmax</option>
                                <option value="softplus">softplus</option>
                                <option value="softsign">softsign</option>
                                <option value="relu">relu</option>
                                <option value="tanh">tanh</option>
                                <option value="sigmoid">sigmoid</option>
                                <option value="hard_sigmoid">hard_sigmoid</option>
                                <option value="linear">linear</option>
                            </select>   
                          </form>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        <br>
        <!-- <button class="delete_selected_button">Delete selected operator / link</button>

        <div id="data">
          <ul>
            <li class="draggable_operator ui-draggable ui-draggable-handle">One</li>
            <li class="draggable_operator ui-draggable ui-draggable-handle">Two</li>
            <li id="upper">Node with Children
              <ul>
                <li>Convolution2D</li>
                <li>ZeroPaddi</li>
              </ul>
            </li>
            <li class="draggable_operator ui-draggable ui-draggable-handle">Threee</li>
          </ul>
        </div>


        <div id="layerTree"></div>
          

        <div class="checkbox-slider--b-flat checkbox-slider-info">
                <label>
                    <input type="checkbox" class="tottle_button" id="tb"><span>Show Advance Options</span>
                </label>
          </div>
          <div class="default_options" style="display:none;">
                <lable for="weights">Weights: </lable><br><input type="text" id="weights" value="None"><br>
          </div> -->

        </div>
            <div class="alert alert-success" id="successMessage" style="display: none;">
                <strong>성공했습니다.</strong>
            </div>
            <div class="alert alert-danger sticky-top" id="dangerMessage" style="display: none;">
                <strong>실패했습니다.</strong>
            </div>
            <div class="alert alert-warning" id="warningMessage" style="display: none;">
                <strong>데이터베이스 오류가 발생 하였습니다.</strong>
            </div>
</div>

{% endblock %}

{% block javascripts %}
{{ block.super }}
<!-- PNotify -->
<script  src="http://code.jquery.com/jquery-latest.min.js?ver=1.0"></script>
<!-- <script src="//code.jquery.com/jquery-1.11.0.min.js?ver=1.0"></script> -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

<!-- <script src="http://code.jquery.com/jquery-1.10.2.js?ver=1"></script> -->
<script src="/static/vendors/pnotify/dist/pnotify.js?ver=1"></script>
<script src="/static/vendors/pnotify/dist/pnotify.buttons.js?ver=1"></script>
<script src="/static/vendors/pnotify/dist/pnotify.nonblock.js?ver=1"></script>

<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js?ver=1.2"></script>
<script src="/static/vendors/jquery_flowchart/jquery.flowchart.js?ver=1.5"></script>
<link rel="stylesheet" href="/static/vendors/jquery_flowchart/jquery.flowchart.min.css?ver=1.2">
<link rel="stylesheet" href="/static/vendors/jquery_flowchart/css/custom.css?ver=1.2">
<script src="/static/vendors/jquery_flowchart/jquery.panzoom.min.js?ver=1.1"></script>

<!-- draggable.js - Entire bundle -->
<script src="https://cdn.jsdelivr.net/npm/@shopify/draggable@1.0.0-beta.7/lib/draggable.bundle.js?ver=1.0"></script>
<!-- <link rel="stylesheet" href="/static/vendors/draggable-1.0.0-beta.6/examples/src/styles/examples-app.scss"> -->

<link rel="stylesheet" href="/static/vendors/jquery_flowchart/jstree/dist/themes/default/style.min.css?ver=1" />
<script type="text/javascript" src="/static/vendors/jquery_flowchart/jstree/dist/jstree.min.js?ver=1"></script>
<script>
    var $operatorTitle = $('#operator_title');
    var $operatorParameter1 = $('#operator_parameter1');
    var $operatorParameter2 = $('#operator_parameter2');
    var $operatorParameter3 = $('#operator_parameter3');
    var $linkColor = $('#link_color');
    var $operatorProperties = $('#operator_properties');
    var $linkProperties = $('#link_properties');

    $(document).ready(function () {
            //     $(document).on("click", ".jstree-icon.jstree-ocl.draggable_operator", function() {
            //   alert("!!!");
            //   $('.jstree-children').children().addClass("draggable_operator");
            //   $('.jstree-children').children().addClass("ui-draggable-handle");
            //   $('.jstree-children').children().addClass("ui-draggable");
            // });
            //////////////////////////////
            // jsTree 생성
            $('#data').jstree({
                "plugins": ["changed"],//[ "wholerow", "checkbox", "changed" ],
            });

            ///////////////////////////////
            var $flowchart = $('#example_9');
            var $container = $flowchart.parent();

            var cx = $flowchart.width() / 2;
            var cy = $flowchart.height() / 2;


            // Panzoom initialization...
            $flowchart.panzoom();

            // Centering panzoom
            $flowchart.panzoom('pan', -cx + $container.width() / 2, -cy + $container.height() / 2);

            // Panzoom zoom handling...
            var possibleZooms = [0.2, 0.4, 0.6, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0];
            var currentZoom = 2;
            $container.on('mousewheel.focal', function (e) {
                e.preventDefault();
                var delta = (e.delta || e.originalEvent.wheelDelta) || e.originalEvent.detail;
                var zoomOut = delta ? delta > 0 : e.originalEvent.deltaY > 0;
                currentZoom = Math.max(0, Math.min(possibleZooms.length - 1, (currentZoom + (zoomOut * 2 - 1))));
                $flowchart.flowchart('setPositionRatio', possibleZooms[currentZoom]);
                $flowchart.panzoom('zoom', possibleZooms[currentZoom], {
                    animate: false,
                    focal: e
                });
            });

            // 처음에 미리 생성할 노드들 설정
            var data = {
                operators: {
                },
                links: {
                },
                parameter1: {
                },
                parameter2: {
                },
                parameter3: {
                }
            };


            // Apply the plugin on a standard, empty div...
            $flowchart.flowchart({
                data: data,
                onOperatorSelect: function (operatorId) {
                    // var temp = $flowchart.flowchart('getData');

                    var op_id = "#operator_" + operatorId;
                    $('.properties').hide();
                    $(op_id).show();

                    $operatorProperties.show();
                    // $operatorTitle.val($flowchart.flowchart('getOperatorTitle', operatorId));
                    // $operatorParameter1.val($flowchart.flowchart('getOperatorParameter1', operatorId));
                    // $operatorParameter2.val($flowchart.flowchart('getOperatorParameter2', operatorId));
                    // $operatorParameter3.val($flowchart.flowchart('getOperatorParameter3', operatorId));
                    $(op_id).show();

                    // if keyup in properties then save values.

                    $(op_id).keyup(function () {
                        //alert("!!!");
                        var selectedOperatorId = $flowchart.flowchart('getSelectedOperatorId');
                        if (selectedOperatorId != null) {
                            $flowchart.flowchart('setOperatorTitle', selectedOperatorId, $operatorTitle.val());
                        }
                    });

                    return true;
                },
                onOperatorUnselect: function () {
                    $('.properties').hide();
                    //$operatorProperties.hide();
                    return true;
                },
                onLinkSelect: function (linkId) {
                    $linkProperties.show();
                    $linkColor.val($flowchart.flowchart('getLinkMainColor', linkId));
                    return true;
                },
                onLinkUnselect: function () {
                    $linkProperties.hide();
                    return true;
                }
            });

            $flowchart.parent().siblings('.delete_selected_button').click(function () {
                $flowchart.flowchart('deleteSelected');
            });


            var $draggableOperators = $('.draggable_operator');

            function getOperatorData($element) {
                //var title = $flowchart.flowchart('getOperatorTitle', operatorId);
                var nbInputs = parseInt($element.data('nb-inputs'));
                var nbOutputs = parseInt($element.data('nb-outputs'));
                var data = {
                    properties: {
                        title: $element.text(),
                        inputs: {},
                        outputs: {},
                        parameter1: "",
                        parameter2: "",
                        parameter2: "",
                    }
                };

                // var i = 0;
                // for (i = 0; i < nbInputs; i++) {
                //   data.properties.inputs['input_' + i] = {
                //     label: 'Input ' + (i + 1)
                //   };
                // }
                // for (i = 0; i < nbOutputs; i++) {
                //   data.properties.outputs['output_' + i] = {
                //     label: 'Output ' + (i + 1)
                //   };
                // }

                data.properties.inputs['input_' + operatorId] = {
                    label: 'Input '
                };

                data.properties.outputs['output_' + operatorId] = {
                    label: 'Output '
                };

                data.properties.parameter1 = "parameter1";
                data.properties.parameter2 = "parameter2";
                data.properties.parameter3 = "parameter3";

                return data;
            }

            var operatorId = 0;

            $draggableOperators.draggable({
                cursor: "move",
                opacity: 0.7,

                helper: 'clone',
                appendTo: 'body',
                zIndex: 1000,

                helper: function (e) {
                    var $this = $(this);
                    var data = getOperatorData($this);
                    return $flowchart.flowchart('getOperatorElement', data);
                },
                stop: function (e, ui) {
                    var $this = $(this);
                    var elOffset = ui.offset;
                    var containerOffset = $container.offset();
                    if (elOffset.left > containerOffset.left &&
                        elOffset.top > containerOffset.top &&
                        elOffset.left < containerOffset.left + $container.width() &&
                        elOffset.top < containerOffset.top + $container.height()) {

                        var flowchartOffset = $flowchart.offset();

                        var relativeLeft = elOffset.left - flowchartOffset.left;
                        var relativeTop = elOffset.top - flowchartOffset.top;

                        var positionRatio = $flowchart.flowchart('getPositionRatio');
                        relativeLeft /= positionRatio;
                        relativeTop /= positionRatio;

                        var data = getOperatorData($this);
                        data.left = relativeLeft;
                        data.top = relativeTop;

                        $temp = $flowchart.flowchart('addOperator', data);

                        var type = $flowchart.flowchart("getOperatorTitle", operatorId);
                        appendOperatorParam(operatorId, type);       // 우측 파라미터 설정 bar 태그 생성

                        operatorId++;
                    }
                }
            });

            $operatorTitle.keyup(function () {
                var selectedOperatorId = $flowchart.flowchart('getSelectedOperatorId');
                if (selectedOperatorId != null) {
                    $flowchart.flowchart('setOperatorTitle', selectedOperatorId, $operatorTitle.val());
                }
            });

            $operatorParameter1.keyup(function () {
                var selectedOperatorId = $flowchart.flowchart('getSelectedOperatorId');
                if (selectedOperatorId != null) {
                    $flowchart.flowchart('setOperatorParameter1', selectedOperatorId, $operatorParameter1.val());
                }
            });

            $operatorParameter2.keyup(function () {
                var selectedOperatorId = $flowchart.flowchart('getSelectedOperatorId');
                if (selectedOperatorId != null) {
                    $flowchart.flowchart('setOperatorParameter2', selectedOperatorId, $operatorParameter2.val());
                }
            });

            $operatorParameter3.keyup(function () {
                var selectedOperatorId = $flowchart.flowchart('getSelectedOperatorId');
                if (selectedOperatorId != null) {
                    $flowchart.flowchart('setOperatorParameter3', selectedOperatorId, $operatorParameter3.val());
                }
            });

            $linkColor.change(function () {
                var selectedLinkId = $flowchart.flowchart('getSelectedLinkId');
                https://map.naver.com/  if (selectedLinkId != null) {
                $flowchart.flowchart('setLinkMainColor', selectedLinkId, $linkColor.val());
            });

            $flowchart.parent().siblings('.delete_selected_button').click(function () {
                $flowchart.flowchart('deleteSelected');
            });

            //////////////////////// return layer sequence
            function getLayerSequence() {
                var links = $flowchart.flowchart('getData').links;

                var sequence = {};


                var i = 0;
                while (1) {
                    if (links[i] == undefined) {
                        if (links.length != 0) {
                            var picker_name = "picker_" + links[i - 1].toOperator;
                            var operator = {};

                            for (var j = 0; j < document.getElementById(picker_name).elements.length; j++) {
                                var operator_key = document.getElementById(picker_name).elements[j].id;           // id
                                operator[operator_key] = document.getElementById(picker_name).elements[j].value;  // value
                            }

                            // 좌표값 저장
                            operator["left"] = document.getElementById(links[i - 1].toOperator).offsetLeft;
                            operator["top"] = document.getElementById(links[i - 1].toOperator).offsetTop;

                            var sequence_key = "op_" + i;
                            sequence[sequence_key] = operator;
                        }
                        break;
                    }

                    var picker_name = "picker_" + links[i].fromOperator;
                    var operator = {};

                    for (var j = 0; j < document.getElementById(picker_name).elements.length; j++) {

                        var operator_key = document.getElementById(picker_name).elements[j].id;           // id
                        operator[operator_key] = document.getElementById(picker_name).elements[j].value;  // value
                    }

                    // 좌표값 저장
                    operator["left"] = document.getElementById(links[i].fromOperator).offsetLeft;
                    operator["top"] = document.getElementById(links[i].fromOperator).offsetTop;

                    var sequence_key = "op_" + i;
                    sequence[sequence_key] = operator;

                    i++;
                }

                var temp = $("#op0").css("left");

                return sequence;
            }

            //////////////////////// 페이지 이동 시 데이터 자동 저장
            var checkUnload = true;

            $(window).on("beforeunload", function () {
                //var sequence = getLayerSequence();
                var sequence = getLayerSequence();

                sequence = JSON.stringify(sequence);


                var upper = {};

                $.ajax({
                    type: "POST",
                    url: "save/",
                    dataType: "json",
                    data: {
                        'csrfmiddlewaretoken': '{{csrf_token }}',
                        'sequence': sequence,
                    },
                    success: function (responseData) {
                    }
                });


                if (checkUnload) return "이 페이지를 벗어나면 작성된 내용은 저장되지 않습니다.";
            });


            $(document).on("click", "#tb", function () {
                $(".default_options").slideToggle("slow");
            });

            // when save_button on click
            $(document).on("click", "#save_button", function () {
                var sequence = getLayerSequence();

                sequence = JSON.stringify(sequence);

                var upper = {};

                $.ajax({
                    type: "POST",
                    url: "save/",
                    dataType: "json",
                    data: {
                        'csrfmiddlewaretoken': '{{csrf_token }}',
                        'sequence': sequence,
                    },
                    success: function (responseData) {
                        autoclosingAlert('#successMessage', 2000);
                    },
                    error: function (xhr, status, error) {
                        console.log(error);
                        autoclosingAlert('#dangerMessage', 2000);
                    }
                });
            });

            // when load button on click
            $(document).on("click", "#load_button", function () {
                alert("load");
            });

        // JSON dictioanary 형태의 데이터에서 다이어그램 구성 정보를 추출하여 다이어그램을 그리는 함수
        function DrawDiagram(JSON_dict) {
            var dict_index = 0;     // JSON dictionary 데이터에 접근할 인덱스 ("op_0", "op_1", ...)

            // JSON dictionary 데이터가 끝날때까지 차례로 순회한다.
            while (JSON_dict["op_" + dict_index] != undefined) {
                var operatorObject = JSON_dict["op_" + dict_index];         // operator 객체 지정
                var data;        // 왼쪽 탭에 있는 data(레이어 종류)

                // var default_left = 400;
                // var default_top = 600;

                switch (operatorObject.operator_title) {
                    case "InputLayer":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">InputLayer</div>'));
                        break;

                    case "OutputLayer":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">OutputLayer</div>'));
                        break;

                    case "Dense":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Dense</div>'));
                        break;

                    case "Dropout":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Dropout</div>'));
                        break;

                    case "Flatten":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Flatten</div>'));
                        break;

                    case "Convolution2D":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">Convolution2D</div>'));
                        break;

                    case "ZeroPadding2D":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">ZeroPadding2D</div>'));
                        break;

                    case "MaxPooling2D":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">MaxPooling2D</div>'));
                        break;

                    case "AveragePooling2D":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">AveragePooling2D</div>'));
                        break;

                    case "LSTM":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">LSTM</div>'));
                        break;

                    case "SimpleRNN":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">SimpleRNN</div>'));
                        break;

                    case "BatchNormalization":
                        data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">BatchNormalization</div>'));
                        break;
                }

                data.left = operatorObject.left;        // 레이어 노드의 좌표(left, top)
                data.top = operatorObject.top;

                //  레이어 파라미터 정보 설정하는 부분 추가해야됨
                var $temp = $flowchart.flowchart('addOperator', data);  // 레이어 노드를 추가한다.
                var type = $flowchart.flowchart('getOperatorTitle', operatorId);
                appendOperatorParam(operatorId, type);
                operatorId++;

                dict_index++;
            }   // while end

            // Link 그리는 부분
            var i = 0;
            while (JSON_dict["op_" + (i + 1)] != undefined) {
                var linkData = {
                    fromOperator: i,
                    fromConnector: "output_" + i,
                    fromSubConnetor: 0,
                    toOperator: i + 1,
                    toConnector: "input_" + (i + 1),
                    toSubConnector: 0
                };

                $flowchart.flowchart('myLinkDiagram', linkData);
                i++;
            }

            console.log(i);
            console.log(data);
        }

        var JSON_dict =  parseJSON2Dict(); 
        DrawDiagram(JSON_dict);
        }); // on ready end



        //우측 세부 파라미터 설정 bar(tab) 태그 생성
        function appendOperatorParam(op_id, type) {
            var content = "";
            var parameterElementId = "operator_" + op_id;
            var picker = "picker_" + op_id;
            var toggleButtonId = "tb_button_" + op_id
            var toggleContentsId = "tb_contents_" + op_id

            switch (type) {
                case "InputLayer":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="dimention_ordering">Input Port : </lable><br>' +
                        '<select id="input_port">' +
                        '<option value="input_port">Input Port</option>' +
                        '</select><br>' +
                        '<lable for="dimention_ordering">Dimention Ordering : </lable><br>' +
                        '<select id="dimention_ordering">' +
                        '<option value="default">softmax</option>' +
                        '<option value="tf">tf (tensorflow)</option>' +
                        '<option value="th">th (theano)</option>' +
                        '</select>' +
                        '</from>' +
                        '</div>';
                    break;

                case "OutputLayer":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="dimention_ordering">Output Port : </lable><br>' +
                        '<select id="output_port">' +
                        '<option value="output_port">Output Port</option>' +
                        '</select><br>' +
                        '</from>' +
                        '</div>';
                    break;

                case "Dense":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="ouput_dimentions">Output Dimentions : </lable><br><input type="text" id="output_dimentions" placeholder="int > 0"><br>' +
                        '<lable for="activation">Activation : </lable><br>' +
                        '<select id="activation">' +
                        '<option value="softmax">softmax</option>' +
                        '<option value="softplus">softplus</option>' +
                        '<option value="softsign">softsign</option>' +
                        '<option value="relu">relu</option>' +
                        '<option value="tanh">tanh</option>' +
                        '<option value="sigmoid">sigmoid</option>' +
                        '<option value="hard_sigmoid">hard_sigmoid</option>' +
                        '<option value="linear">linear</option>' +
                        '</select><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="weights">Weights: </lable><br><input type="text" id="weights" value="None"><br>' +
                        '<lable for="weight_initialization_function">Weight Initialization Function : </lable><br>' +
                        '<select id="weight_initialization_function">' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="regularizer_for_input_wegiht">Regularizer for input wegiht : </lable><br><input type="text" id="regularizer_for_input_wegiht" value="None"><br>' +
                        '<lable for="activitiy_regularizer">Activity Regularizer : </lable><br><input type="text" id="activitiy_regularizer" value="None"><br>' +
                        '<lable for="bias_regularizer">Bias Regularizer : </lable><br><input type="text" id="bias_regularizer" value="None"><br>' +
                        '<lable for="bias">Bias : </lable><br><input type="text" id="bias" value="None"><br>' +
                        '<lable for="bias_constraint">Bias Constraint : </lable><br><input type="text" id="bias_constraint" value="None"><br>' +
                        '<lable for="input_dimention">Input Dimention : </lable><br><input type="text" id="input_dimention" value="None"><br>' +
                        '<lable for="weight">Weight : </lable><br><input type="text" id="weight" value="None"><br>' +
                        '</div>' +
                        '</form>' +
                        '</div>';
                    break;
                case "Dropout":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="fraction_to_drop">Fraction to Drop: </lable><br><input type="text" id="fraction_to_drop" placeholder="Float between 0 and 1. fraction of the input units to drop."><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="noise_shape">Noise Shape : </lable><br><input type="text" id="noise_shape" value="None"><br>' +
                        '<lable for="seed">Seed : </lable><br><input type="text" id="seed" value="None"><br>' +
                        '</div>' +
                        '</from>' +
                        '</div>';
                    break;
                case "Flatten":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '</form>' +
                        '</div>';
                    break;

                case "Convolution2D":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="filter_rows">Filter Rows : </lable><br><input type="text" id="filter_rows"><br>' +
                        '<lable for="number_of_filters">Number of Filters : </lable><br><input type="text" id="number_of_filters"><br>' +
                        '<lable for="filter_columns">Filter Columns : </lable><br><input type="text" id="filter_columns"><br>' +
                        '<lable for="activation">Activation : </lable><br>' +
                        '<select id="activation">' +
                        '<option value="softmax">softmax</option>' +
                        '<option value="softplus">softplus</option>' +
                        '<option value="softsign">softsign</option>' +
                        '<option value="relu">relu</option>' +
                        '<option value="tanh">tanh</option>' +
                        '<option value="sigmoid">sigmoid</option>' +
                        '<option value="hard_sigmoid">hard_sigmoid</option>' +
                        '<option value="linear">linear</option>' +
                        '</select><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="weight">Weight : </lable><br><input type="text" id="weight" value="None"><br>' +
                        '<lable for="bias_regularizer">Bias Regularizer : </lable><br><input type="text" id="bias_regularizer" value="None"><br>' +
                        '<lable for="regularizer_for_input_weight">Regularizer for Input Weight : </lable><br><input type="text" id="regularizer_for_input_weight" value="None"><br>' +
                        '<lable for="activity_regularizer">Activity Regularizer : </lable><br><input type="text" id="activity_regularizer" value="None"><br>' +
                        '<lable for="weight_initialization_function">Weight Initialization Function : </lable><br>' +
                        '<select id="weight_initialization_function">' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="dimension_ordering">Dimension Ordering : </lable><br>' +
                        '<select id="dimension_ordering">' +
                        '<option value="default">zero</option>' +
                        '<option value="tf">tf (tensorflow)</option>' +
                        '<option value="th">th (theano)</option>' +
                        '</select><br>' +
                        '<lable for="subsampling">Subsampling : </lable><br><input type="text" id="subsampling" value="(1, 1)"><br>' +
                        '<lable for="border_mode">Border Mode : </lable><br>' +
                        '<select id="border_mode">' +
                        '<option value="valid">valid</option>' +
                        '<option value="same">same</option>' +
                        '</select><br>' +
                        '<lable for="bias_constraint">Bias Constraint : </lable><br><input type="text" id="bias_constraint" value="None"><br>' +
                        '<lable for="bias">Bias : </lable><br><input type="text" id="bias" value="None"><br>' +
                        '<lable for="weight_constraint">Weight Constraint : </lable><br><input type="text" id="weight_constraint" value="None"><br>' +
                        '</div>' +
                        '</form>' +
                        '</div>';
                    break;

                case "ZeroPadding2D":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="zero_padding_lyer">Zero-Padding layer for 2d input</lable><br><input type="text" id="zero_padding_layer"><br>' +
                        '</form>' +
                        '<div>';
                    break;

                case "Maxpooling2D":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="pool_size">Pool Size: </lable><br><input type="text" id="pool_size" placeholder="Number of rows in the convolution kernel."><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="strides">Strides : </lable><br><input type="text" id="strides" value="None"><br>' +
                        '<lable for="border_mode">Border Mode : </lable><br>' +
                        '<select id="border_mode">' +
                        '<option value="valid">valid</option>' +
                        '<option value="same">same</option>' +
                        '</select><br>' +
                        '<lable for="dimension_ordering">Dimension Ordering : </lable><br>' +
                        '<select id="dimension_ordering">' +
                        '<option value="default">zero</option>' +
                        '<option value="tf">tf (tensorflow)</option>' +
                        '<option value="th">th (theano)</option>' +
                        '</select><br>' +
                        '</div>' +
                        '</from>' +
                        '</div>';
                    break;
                case "AveragePooling2D":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="pool_size">Pool Size: </lable><br><input type="text" id="pool_size" placeholder="Number of rows in the convolution kernel."><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="strides">Strides : </lable><br><input type="text" id="strides" value="None"><br>' +
                        '<lable for="border_mode">Border Mode : </lable><br>' +
                        '<select id="border_mode">' +
                        '<option value="valid">valid</option>' +
                        '<option value="same">same</option>' +
                        '</select><br>' +
                        '<lable for="dimension_ordering">Dimension Ordering : </lable><br>' +
                        '<select id="dimension_ordering">' +
                        '<option value="default">zero</option>' +
                        '<option value="tf">tf (tensorflow)</option>' +
                        '<option value="th">th (theano)</option>' +
                        '</select><br>' +
                        '</div>' +
                        '</from>' +
                        '</div>';
                    break;
                case "LSTM":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="activation">Activation : </lable><br>' +
                        '<select id="activation">' +
                        '<option value="softmax">softmax</option>' +
                        '<option value="softplus">softplus</option>' +
                        '<option value="relu">relu</option>' +
                        '<option value="tanh">tanh</option>' +
                        '<option value="sigmoid">sigmoid</option>' +
                        '<option value="hard_sigmoid">hard_sigmoid</option>' +
                        '<option value="linear">linear</option>' +
                        '</select><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="go_backwards">Go Backwards : </lable><br>' +
                        '<select id="go_backwards">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="unroll">Unroll : </lable><br>' +
                        '<select id="unroll">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="regularizer_for_input_weight">Regularizer for Input Weight : </lable><br><input type="text" id="regularizer_for_input_weight" value="None"><br>' +
                        '<lable for="dropout_rate_for_grate">Dropout Rate for Grate : </lable><br><input type="text" id="dropout_rate_for_grate" value="0"><br>' +
                        '<lable for="input_length">Input Length : </lable><br><input type="text" id="input_length" value="None"><br>' +
                        '<lable for="stateful">Stateful : </lable><br>' +
                        '<select id="stateful">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="input_dimention">Input Dimention : </lable><br><input type="text" id="input_dimention" value="None"><br>' +
                        '<lable for="forge_bias_init">Forge Bias init : </lable><br>' +
                        '<select id="forge_bias_init">' +
                        '<option value="uniform">uniform</option>' +
                        '<option value="lecun_uniform">lecun_uniform</option>' +
                        '<option value="normal">normal</option>' +
                        '<option value="identity">identity</option>' +
                        '<option value="orthogonal">orthogonal</option>' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="weight_initialization_function">Weight Initialization Function : </lable><br>' +
                        '<select id="weight_initialization_function">' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="return_sequence">Return Sequence : </lable><br>' +
                        '<select id="return_sequence">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="drop_rate">Drop Rate : </lable><br><input type="text" id="drop_rate" value="0"><br>' +
                        '</div>' +
                        '</form>' +
                        '</div>';
                    break;
                case "SimpleRNN":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="activation">Activation : </lable><br>' +
                        '<select id="activation">' +
                        '<option value="softmax">softmax</option>' +
                        '<option value="softplus">softplus</option>' +
                        '<option value="relu">relu</option>' +
                        '<option value="tanh">tanh</option>' +
                        '<option value="sigmoid">sigmoid</option>' +
                        '<option value="hard_sigmoid">hard_sigmoid</option>' +
                        '<option value="linear">linear</option>' +
                        '</select><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="go_backwards">Go Backwards : </lable><br>' +
                        '<select id="go_backwards">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="unroll">Unroll : </lable><br>' +
                        '<select id="unroll">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="regularizer_for_input_weight">Regularizer for Input Weight : </lable><br><input type="text" id="regularizer_for_input_weight" value="None"><br>' +
                        '<lable for="dropout_rate_for_grate">Dropout Rate for Grate : </lable><br><input type="text" id="dropout_rate_for_grate" value="0"><br>' +
                        '<lable for="input_length">Input Length : </lable><br><input type="text" id="input_length" value="None"><br>' +
                        '<lable for="stateful">Stateful : </lable><br>' +
                        '<select id="stateful">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="input_dimention">Input Dimention : </lable><br><input type="text" id="input_dimention" value="None"><br>' +
                        '<lable for="consume_less">Consume Less : </lable><br>' +
                        '<select id="consume_less">' +
                        '<option value="CPU">CPU</option>' +
                        '<option value="mem">mem</option>' +
                        '<option value="GPU">GPU</option>' +
                        '</select><br>' +
                        '<lable for="weights">Weights : </lable><br><input type="text" id="weights" value="None"><br>' +
                        '<lable for="bias_regularizer">Bias Regularizer : </lable><br><input type="text" id="bias_regularizer" value="None"><br>' +
                        '<lable for="return_sequence">Return Sequence : </lable><br>' +
                        '<select id="return_sequence">' +
                        '<option value="true">true</option>' +
                        '<option value="false">false</option>' +
                        '</select><br>' +
                        '<lable for="initialization_for_inner_cells">Initialization for Inner Cells : </lable><br>' +
                        '<select id="initialization_for_inner_cells">' +
                        '<option value="uniform">uniform</option>' +
                        '<option value="lecun_uniform">lecun_uniform</option>' +
                        '<option value="normal">normal</option>' +
                        '<option value="identity">identity</option>' +
                        '<option value="orthogonal">orthogonal</option>' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="weight_initialization_function">Weight Inititalization Function : </lable><br>' +
                        '<select id="weight_initialization_function">' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="regularizer_for_recurrent_weight">Regularizer for Recurrent Weight : </lable><br><input type="text" id="regularizer_for_recurrent_weight" value="None"><br>' +
                        '<lable for="dropout_rate">Dropout Rate : </lable><br><input type="text" id="dropout_rate" value="0"><br>' +
                        '</div>' +
                        '</form>' +
                        '</div>';
                    break;

                case "BatchNormalization":
                    content += '<div id="' + parameterElementId + '" class="properties">' +
                        '<form id="' + picker + '">' +
                        '<lable for="title">title: </lable><br><input type="text" id="operator_title" disabled value="' + type + '"><br>' +
                        '<lable for="mode">Mode : </lable><br>' +
                        '<select id="mode">' +
                        '<option value="0">0</option>' +
                        '<option value="1">1</option>' +
                        '<option value="2">2</option>' +
                        '</select><br><br>' +
                        '<div class=" checkbox-slider--b-flat checkbox-slider-info">' +
                        '<label>' +
                        '<input type="checkbox" class="tottle_button" id="' + toggleButtonId + '" onclick="toggle(' + op_id + ');"><span>Show Advance Options</span>' +
                        '</label>' +
                        '</div>' +
                        '<div id="' + toggleContentsId + '" style="display:none;">' +
                        '<lable for="numeric_stability_constant">Numeric Stability Constant: </lable><br><input type="text" id="numeric_stability_constant" value="0.001"><br>' +
                        '<lable for="parameter_update_momentum">Parameter Update Momentum: </lable><br><input type="text" id="parameter_update_momentum" value="0.99"><br>' +
                        '<lable for="beta_regulrizer">Beta Regularizer: </lable><br><input type="text" id="beta_regulrizer" value="None"><br>' +
                        '<lable for="weights">Weights: </lable><br><input type="text" id="weights" value="None"><br>' +
                        '<lable for="gamma_init">Gamma Init: </lable><br>' +
                        '<select id="gamma_init">' +
                        '<option value="uniform">uniform</option>' +
                        '<option value="lecun_uniform">lecun_uniform</option>' +
                        '<option value="normal">normal</option>' +
                        '<option value="identity">identity</option>' +
                        '<option value="orthogonal">orthogonal</option>' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="axis">Axis: </lable><br><input type="text" id="axis" value="-1"><br>' +
                        '<lable for="beta_init">Beta Init: </lable><br>' +
                        '<select id="beta_init">' +
                        '<option value="uniform">uniform</option>' +
                        '<option value="lecun_uniform">lecun_uniform</option>' +
                        '<option value="normal">normal</option>' +
                        '<option value="identity">identity</option>' +
                        '<option value="orthogonal">orthogonal</option>' +
                        '<option value="zero">zero</option>' +
                        '<option value="glorot_normal">glorot_normal</option>' +
                        '<option value="glorot_uniform">glorot_uniform</option>' +
                        '<option value="he_normal">he_normal</option>' +
                        '<option value="he_uniform">he_uniform</option>' +
                        '<option value="one">one</option>' +
                        '</select><br>' +
                        '<lable for="gamma_regularizer">Gamma Regularizer: </lable><br><input type="text" id="gamma_regularizer" value="None"><br>' +
                        '</div>' +
                        '</from>' +
                        '</div>';
                    break;

                default:
                    console.log("nothing");
            }

            $("#parameter_bar").append(content);

            return parameterElementId;

        }


        ////////////////////////// slide toggle
        function toggle(op_id) {
            var id = "#" + "tb_contents_" + op_id;

            $(id).slideToggle("slow");
        }

        // alert 
        function autoclosingAlert(selector, delay) {
            var alert = $(selector).alert();
            alert.show();
            window.setTimeout(function () { alert.hide() }, delay);
        }


        // Django에서 넘어온 JSON String 형태의 데이터를 Json Dict 형태로 변환하여 반환하는 함수
        function parseJSON2Dict() {
            json_str = "{{ foo }}".replace(/&quot;/gi, "\""); // 정규식을 이용하여 &quot; 를 " 으로 모두 치환한다.
            json_data = JSON.parse(json_str);   // string 타입의 json정보를 갖고 있는 변수를 json 타입으로 변환한다.

            return json_data;
        }




        // var data = getOperatorData($('<div class="draggable_operator ui-draggable ui-draggable-handle" data-nb-inputs="1" data-nb-outputs="1">InputLayer</div>'));
        //     data.left = 700;
        //     data.top = 700;
        //     $temp = $flowchart.flowchart('addOperator', data);
        //     var type = $flowchart.flowchart("getOperatorTitle", operatorId);
        //     appendOperatorParam(operatorId, type);       // 우측 파라미터 설정 bar 태그 생성
        //     operatorId++;


</script>
{% endblock javascripts %}